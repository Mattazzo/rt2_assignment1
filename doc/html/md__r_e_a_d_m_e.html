<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>rt2_assignment1 - branch &#39;ros2&#39;  - Matteo Azzini 4475165: rt2_assignment1 - branch &#39;ros2&#39; - Matteo Azzini 4475165</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">rt2_assignment1 - branch &#39;ros2&#39;  - Matteo Azzini 4475165
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="namespacert2__assignment1.html">rt2_assignment1</a> - branch 'ros2' - Matteo Azzini 4475165 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md1"></a>
Requirements</h1>
<p>In this branch I was required to write FSM and position server nodes for ROS2, as components, so that, by using the <em>ros1_bridge</em>, they can be interfaces with the ROS nodes and with the simulation in Gazebo. The <em>go_to_point</em> can still be implemented as a service.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Package Composition</h1>
<p>The package contains the folllowing elements:</p><ul>
<li><b>doc</b>: folder with documentation about the package, generated with doxygen </li>
<li><b>include</b>: folder required for a ROS2 package </li>
<li><b>launch</b>: folder with a launch file to start a container and load the two components written in cpp </li>
<li><b>src</b>: folder with the nodes written in cpp as components</li>
<li><b>srv</b>: folder with .srv files to define the services</li>
<li><b>CMakeList.txt</b>: file required to build the pacakge</li>
<li><b>mapping_rules.yaml</b>: file in .yaml extension to define which packages and messages/services should be bridged for the communication ROS-ROS2</li>
<li><b>pacakage.xml</b>: file required to build the package</li>
<li><b>start_sim_ros2_gazebo.sh</b>: script to start the whole simulation on Gazebo</li>
<li><b>start_sim_ros2_coppelia.sh</b>: script to start the whole simulation on Vrep</li>
<li><b>scene.ttt</b>: Vrep scene</li>
</ul>
<h1><a class="anchor" id="autotoc_md3"></a>
Code Explanation</h1>
<h2><a class="anchor" id="autotoc_md4"></a>
Launch files&lt;/br&gt;</h2>
<ul>
<li><b><a class="el" href="launch_8py.html">launch.py</a></b>: file to start a container and load inside two nodes written as components in src folder</li>
</ul>
<h2><a class="anchor" id="autotoc_md5"></a>
src&lt;/br&gt;</h2>
<ul>
<li><b><a class="el" href="state__machine_8cpp.html">state_machine.cpp</a></b>: implements a ROS2 component that declares a server for Command server , a client for RandomPosition service and a client for Position service. It receives the request from <em>user_interface</em> node in ROS, if user require to start the robot, this component sends a request for a random position and call <em>go_to_point</em> node to let the robot reach the goal. Otherwise, if the robot is moving and user requests to stop it, the component doesn't do anything, because <em>go_to_point</em> node stop automatically the robot when the goal is reached</li>
<li><b><a class="el" href="position__server_8cpp.html">position_server.cpp</a></b>: implements a server, as ROS2 component, which receives as request the minimum and maximum value, within choose x and y coordinates. As response returns random x, y coordinates and the heading theta for a goal position</li>
</ul>
<h2><a class="anchor" id="autotoc_md6"></a>
srv&lt;/br&gt;</h2>
<ul>
<li><b>Command.srv</b>: Definition of Command service used to send a command to control the robot </li>
<li><b>Position.srv</b>: Definition of Position service used to reach a goal position</li>
<li><b>RandomPosition.srv</b>: Definition of RandomPosition used to get a random goal position</li>
</ul>
<h1><a class="anchor" id="autotoc_md7"></a>
Required Packages</h1>
<p>To test this code is required the <em>ros1_bridge</em> package and <em><a class="el" href="namespacert2__assignment1.html">rt2_assignment1</a></em> package in its original version, available in this repository, in branch 'main'.</p>
<h1><a class="anchor" id="autotoc_md8"></a>
How to execute the code</h1>
<h2><a class="anchor" id="autotoc_md9"></a>
Simulation on Gazebo manually</h2>
<ol type="1">
<li>Download and build this package in the src folder of your ROS2 worksapace, the same should be done for <em>ros1_bridge</em> package</li>
<li>Download and build <em><a class="el" href="namespacert2__assignment1.html">rt2_assignment1</a></em> package in the src folder of your ROS workspace</li>
<li>Open the first terminal, source ROS environment, go into your ROS workspace and execute <div class="fragment"><div class="line">roslaunch rt2_assignment1 sim_ros2_gazebo.launch</div>
</div><!-- fragment --></li>
</ol>
<p>N.B. <em>sim_ros2_gazebo.launch</em> file is available in launch folder of branch 'main' of <a class="el" href="namespacert2__assignment1.html">rt2_assignment1</a> repository </p>
<ol type="1">
<li>Open a second terminal, source ROS and ROS2 environments, go into your ROS2 workspace and execute <br  />
 <div class="fragment"><div class="line">ros2 run ros1_bridge dynamic_bridge</div>
</div><!-- fragment --></li>
<li>Open a third terminal, source ROS2 environment, go into your ROS2 workspace and execute <div class="fragment"><div class="line">ros2 launch rt2_assignment1 launch.py</div>
</div><!-- fragment --></li>
</ol>
<h2><a class="anchor" id="autotoc_md10"></a>
Simulation on Gazebo by a script</h2>
<p>Points 3,4 and 5 can be replaced by a script already availabe in this package. Copy this script in your root folder, make it executable and the execute it with: </p><div class="fragment"><div class="line">./start_sim_ros2_gazebo.sh</div>
</div><!-- fragment --><p>N.B. Before use this script you have to install <em>gnome-terminal</em> to open multiple terminals by script by running on your terminal. Pay also attention to the path for workingspaces in the script, you have to modify them in according with your workingspaces paths</p>
<h2><a class="anchor" id="autotoc_md11"></a>
Simulation on Vrep manually</h2>
<p>To execute this simulation on Vrep instead of Gazebo follow the procedure above replacing <em>sim_ros2_gazebo.launch</em> with <em>sim_ros2_coppelia.launch</em> in point 3 ( file available in 'main' branch of <a class="el" href="namespacert2__assignment1.html">rt2_assignment1</a> repository) Once you have completed all previous steps, to start Vrep simulator you have to open a new terminal, source ROS environment, go into <em>CoppeliaSim_Edu_V4_2_0_Ubuntu20_04</em> folder and execute: </p><div class="fragment"><div class="line">./coppeliaSim.sh</div>
</div><!-- fragment --><p>From Vrep GUI you can open the scene <em>scene.ttt</em> available in this branch or in 'main' branch and start the simulator with the play button. N.B. If you dont't have already <em>CoppeliaSim_Edu_V4_2_0_Ubuntu20_04</em> folder, you can download it from this link: <a href="http://www.coppeliarobotics.com/downloads.html">http://www.coppeliarobotics.com/downloads.html</a></p>
<h2><a class="anchor" id="autotoc_md12"></a>
Simulation on Vrep by a script</h2>
<p>As before you can run the simulation using the script <em>start_sim_ros2_coppelia.sh</em> available in this package: </p><div class="fragment"><div class="line">./start_sim_ros2_coppelia.sh</div>
</div><!-- fragment --><p>N.B. Before use this script you have to install <em>gnome-terminal</em> to open multiple terminals by script by running on your terminal. Pay also attention to the path for workingspaces in the script, you have to modify them in according with your workingspaces paths, also fro the path of <em>CoppeliaSim_Edu_V4_2_0_Ubuntu20_04</em> folder </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
